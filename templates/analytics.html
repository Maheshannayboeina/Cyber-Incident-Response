{% extends 'base.html' %}
{% block title %}Analytics - Incident Response{% endblock %}
{% block head %}
<style>
    #heatmap-container {
        height: 500px;
        width: 100%
    }
</style>
{% endblock %}
{% block content %}
<section class="hero-section d-flex justify-content-center align-items-center" id="section_1">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-12 mx-auto">
                <h1 class="text-white text-center">Real-Time Cybercrime Analytics (India)</h1>
                <h6 class="text-center">A visual representation of cybercrime trends. (Mockup)</h6>
                <div class="analytics-container">
                    <div id="heatmap-container" style="height: 500px; background: #eee; margin-top: 20px;">
                        <p style="text-align: center; padding: 150px;">Heatmap Placeholder: Real-time data visualization will
                            be displayed here </p>
                    </div>
                    <p class="text-center analytics-text">This page is for showing real-time statistics of cyber crimes in
                        India. The heat map will show how the crimes are distributed geographically. </p>
                    <p class="text-center analytics-text">This is a mockup and the data is not live.</p>
                </div>
            </div>
        </div>
    </div>
</section>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-ZxogXyjRz6d1aH1i/74sZ98v7u1yK77Z6w7J66gq74=" crossorigin=""></script>
<script>
    function initMap() {
        var mapDiv = document.getElementById('heatmap-container')
        if (!mapDiv) {
            console.error("Heatmap container element not found!");
            return;
        }
        console.log("mapDiv is:", mapDiv)
        var map = L.map('heatmap-container').setView([20.5937, 78.9629], 5); // India coordinates and zoom level
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        var cyberCrimeData = [ // Mock Data
            [28.7041, 77.1025, 10],
            [19.0760, 72.8777, 15],
            [12.9716, 77.5946, 20],
            [22.5726, 88.3639, 12],
            [26.9124, 75.7873, 10]
        ];
        // Convert mock data to circle markers
        cyberCrimeData.forEach(function (incident) {
            L.circle([incident[0], incident[1]], {
                color: 'red',
                fillColor: '#f03',
                fillOpacity: 0.5,
                radius: incident[2] * 1000
            }).addTo(map);
        });
        console.log("Map initialized");
    }
    window.onload = function () {
        setTimeout(initMap, 100);
    };
    // fetch('/api/cybercrime-data')
    //   .then(response => response.json())
    //  .then(data => {
    //    // use the fetched data to create the map and other charts
    //})
</script>
{% endblock %}